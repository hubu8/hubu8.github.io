<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>索引初识:索引机制、分类、使用与管理 - Eccentric&#39;s Note</title><meta name="Description" content="本站主要用来收集整理资料、记录笔记，方便自己查询使用。"><meta property="og:url" content="https://hubu8.github.io/posts/%E7%B4%A2%E5%BC%95%E5%88%9D%E8%AF%86%E7%B4%A2%E5%BC%95%E6%9C%BA%E5%88%B6%E5%88%86%E7%B1%BB%E4%BD%BF%E7%94%A8%E4%B8%8E%E7%AE%A1%E7%90%86/">
  <meta property="og:site_name" content="Eccentric&#39;s Note">
  <meta property="og:title" content="索引初识:索引机制、分类、使用与管理">
  <meta property="og:description" content="本站主要用来收集整理资料、记录笔记，方便自己查询使用。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-11-26T16:00:30+08:00">
    <meta property="article:modified_time" content="2022-11-26T16:00:30+08:00">
    <meta property="article:tag" content="索引使用">
    <meta property="og:image" content="https://hubu8.github.io/logo.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://hubu8.github.io/logo.png">
  <meta name="twitter:title" content="索引初识:索引机制、分类、使用与管理">
  <meta name="twitter:description" content="本站主要用来收集整理资料、记录笔记，方便自己查询使用。">
<meta name="application-name" content="Eccentric&#39;s Note">
<meta name="apple-mobile-web-app-title" content="Eccentric&#39;s Note"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/header_images/favicon-32x32.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://hubu8.github.io/posts/%E7%B4%A2%E5%BC%95%E5%88%9D%E8%AF%86%E7%B4%A2%E5%BC%95%E6%9C%BA%E5%88%B6%E5%88%86%E7%B1%BB%E4%BD%BF%E7%94%A8%E4%B8%8E%E7%AE%A1%E7%90%86/" /><link rel="prev" href="https://hubu8.github.io/posts/java%E5%88%A4%E6%96%AD%E5%AD%97%E7%AC%A6%E4%B8%B2string%E6%98%AF%E5%90%A6%E4%B8%BA%E7%A9%BA/" /><link rel="next" href="https://hubu8.github.io/posts/%E5%BB%BA%E7%AB%8B%E7%B4%A2%E5%BC%95%E7%9A%84%E6%AD%A3%E7%A1%AE%E5%A7%BF%E5%8A%BF%E4%B8%8E%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95%E7%9A%84%E6%9C%80%E4%BD%B3%E6%8C%87%E5%8D%97/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "索引初识:索引机制、分类、使用与管理",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/hubu8.github.io\/posts\/%E7%B4%A2%E5%BC%95%E5%88%9D%E8%AF%86%E7%B4%A2%E5%BC%95%E6%9C%BA%E5%88%B6%E5%88%86%E7%B1%BB%E4%BD%BF%E7%94%A8%E4%B8%8E%E7%AE%A1%E7%90%86\/"
        },"genre": "posts","keywords": "索引使用","wordcount":  12166 ,
        "url": "https:\/\/hubu8.github.io\/posts\/%E7%B4%A2%E5%BC%95%E5%88%9D%E8%AF%86%E7%B4%A2%E5%BC%95%E6%9C%BA%E5%88%B6%E5%88%86%E7%B1%BB%E4%BD%BF%E7%94%A8%E4%B8%8E%E7%AE%A1%E7%90%86\/","datePublished": "2022-11-26T16:00:30+08:00","dateModified": "2022-11-26T16:00:30+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Eccentric"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Eccentric&#39;s Note">Eccentric&#39;s Note</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/"> 首页 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/posts/"> 归档 </a><a class="menu-item" href="/pdflist/"><i class='fa-solid fa-book'></i> pdf </a><a class="menu-item" href="/friend/" title="友链"><i class='fa-solid fa-link'></i> 友链 </a><a class="menu-item" href="/about/"> 关于 </a><a class="menu-item" href="https://github.com/hubu8" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Eccentric&#39;s Note">Eccentric&#39;s Note</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/" title="">首页</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/posts/" title="">归档</a><a class="menu-item" href="/pdflist/" title=""><i class='fa-solid fa-book'></i>pdf</a><a class="menu-item" href="/friend/" title="友链"><i class='fa-solid fa-link'></i>友链</a><a class="menu-item" href="/about/" title="">关于</a><a class="menu-item" href="https://github.com/hubu8" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">索引初识:索引机制、分类、使用与管理</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Eccentric</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>数据库</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2022-11-26">2022-11-26</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;约 12166 字&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;预计阅读 25 分钟&nbsp;<span id="/posts/%E7%B4%A2%E5%BC%95%E5%88%9D%E8%AF%86%E7%B4%A2%E5%BC%95%E6%9C%BA%E5%88%B6%E5%88%86%E7%B1%BB%E4%BD%BF%E7%94%A8%E4%B8%8E%E7%AE%A1%E7%90%86/" class="leancloud_visitors" data-flag-title="索引初识:索引机制、分类、使用与管理">
                        <i class="far fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;次阅读
                    </span>&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#引言">引言</a></li>
    <li><a href="#一mysql索引机制概述">一、MySQL索引机制概述</a>
      <ul>
        <li><a href="#11mysql索引的创建方式">1.1、MySQL索引的创建方式</a></li>
        <li><a href="#12查询删除指定索引">1.2、查询、删除、指定索引</a></li>
        <li><a href="#13数据库索引的本质">1.3、数据库索引的本质</a></li>
      </ul>
    </li>
    <li><a href="#二mysql的索引分类">二、MySQL的索引分类</a>
      <ul>
        <li><a href="#21数据结构层次">2.1、数据结构层次</a></li>
        <li><a href="#22字段数量层次">2.2、字段数量层次</a></li>
        <li><a href="#23功能逻辑层次">2.3、功能逻辑层次</a>
          <ul>
            <li><a href="#全文索引">全文索引</a></li>
            <li><a href="#空间索引">空间索引</a></li>
          </ul>
        </li>
        <li><a href="#24存储方式层次">2.4、存储方式层次</a></li>
        <li><a href="#25索引分类小结">2.5、索引分类小结</a></li>
      </ul>
    </li>
    <li><a href="#三mysql其他索引的创建使用方式">三、MySQL其他索引的创建使用方式</a>
      <ul>
        <li><a href="#31唯一索引的创建与使用">3.1、唯一索引的创建与使用</a></li>
        <li><a href="#32主键索引的创建与使用">3.2、主键索引的创建与使用</a></li>
        <li><a href="#33全文索引的创建与使用">3.3、全文索引的创建与使用</a>
          <ul>
            <li><a href="#自然语言模式">自然语言模式</a></li>
            <li><a href="#布尔搜索模式">布尔搜索模式</a></li>
            <li><a href="#查询拓展搜索">查询拓展搜索</a></li>
          </ul>
        </li>
        <li><a href="#34空间索引的创建与使用">3.4、空间索引的创建与使用</a></li>
        <li><a href="#35联合索引的创建与使用">3.5、联合索引的创建与使用</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="四mysql之索引初识篇索引机制索引分类索引使用与管理综述">(四)MySQL之索引初识篇：索引机制、索引分类、索引使用与管理综述</h1>
<h2 id="引言">引言</h2>
<p>由于<code>MySQL</code>是作为存储层部署在业务系统的最后端，所有的业务数据最终都要入库落盘，但随着一个项目在线上运行的时间越来越久，数据库中的数据量自然会越来越多，而数据体积出现增长后，当需要从表查询一些数据时，效率会越发低下。在正常情况下，表的查询性能和数据量是成反比的，也就是数据越多，查询越慢。</p>
<blockquote>
<p>这是什么原因导致的呢？由于<code>MySQL</code>默认的查询方式导致的，举个例子~</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="o">`</span><span class="n">zz_student</span><span class="o">`</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------+--------+------+--------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">student_id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">sex</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------+--------+------+--------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">          </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">竹子</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="err">男</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="mi">185</span><span class="n">cm</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">          </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">熊猫</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="err">女</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="mi">170</span><span class="n">cm</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">          </span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">子竹</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="err">男</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="mi">182</span><span class="n">cm</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">          </span><span class="mi">4</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">棕熊</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="err">男</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="mi">187</span><span class="n">cm</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">          </span><span class="mi">5</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">黑豹</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="err">男</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="mi">177</span><span class="n">cm</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">          </span><span class="mi">6</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">脑斧</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="err">男</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="mi">178</span><span class="n">cm</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">          </span><span class="mi">7</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">兔纸</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="err">女</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="mi">165</span><span class="n">cm</span><span class="w">  </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------+--------+------+--------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="o">`</span><span class="n">zz_student</span><span class="o">`</span><span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;脑斧&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>上面给出了一张学生表，其中有七位学生信息，而此时要查询姓名为「脑斧」的学生信息时，<code>MySQL</code>底层是如何检索数据的呢？会触发磁盘<code>IO</code>，对表中的数据进行逐条读取并判断，也就是说，在这里想要查找到符合要求的数据，至少要经过六次磁盘<code>IO</code>才能检索到目标（暂且先不考虑局部性读取原理与随机<code>IO</code>）。</p>
<ul>
<li>那假设这个表中有<code>1000W</code>条数据呢？要查的目标数据位于表的<code>900W</code>行以后怎么办？岂不是要触发几百万次磁盘<code>IO</code>才能检索到数据啊，如果真的这样去干，其效率大家可想而知。</li>
</ul>
<blockquote>
<p>在这种情况下，又该如何去提升数据库的查询性能呢？因为查询往往都是一个业务系统中最频繁的操作，一般项目的写/读请求比例都遵循三七定律，也就是<code>30%</code>的请求会涉及到写库操作，另外<code>70%</code>则属于查库类型的操作。</p></blockquote>
<p>在思考如何提升查询性能前，咱们不妨先回想一下小时候的场景，小时候由于刚接触汉字，很多字都不认识，所以通常每个人小时候都会拥有一本「新华字典」，但一本字典那么厚，我们是一页页去翻的吗？并不是，字典中有目录索引，我们可以根据音节、偏旁等方式查找不认识的字。
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./images/6b14b218a98947c9add20a470ec0a6a0tplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp"
        data-srcset="./images/6b14b218a98947c9add20a470ec0a6a0tplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp, ./images/6b14b218a98947c9add20a470ec0a6a0tplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp 1.5x, ./images/6b14b218a98947c9add20a470ec0a6a0tplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp 2x"
        data-sizes="auto"
        alt="./images/6b14b218a98947c9add20a470ec0a6a0tplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp"
        title="新华字典" />
在「新华字典」中一页页翻找某个汉字，就类似于我们前面给出的全表扫描方式，效率特别特别低，而通过目录索引则能够在很短的时间内找到目标汉字。</p>
<p>既然字典中都存在目录索引页，能帮助小时候的我们快速检索汉字，那这个思想能否应用到数据库中来呢？答案是当然可以，并且<code>MySQL</code>也提供了索引机制，索引是数据库中的核心组件之一，一张表中建立了合适的索引后，往往在面对海量数据查询时，能够事半功倍，接下来一起聊一聊<code>MySQL</code>的索引。</p>
<blockquote>
<p>索引机制会分为上、中、下三篇进行阐述，大致内容如下：
《上篇：索引初识篇》主要讲解索引的概述、分类、使用与管理等；
《中篇：索引应用篇》主要阐述索引优劣分析、建立索引的原则、索引失效的场景、如何正确的使用索引、索引优化机制等；
《下篇：索引原理篇》则主要讲述索引的底层实现、<code>B+Tree、Hash</code>数据结构、聚簇索引和非聚簇索引实现、索引查询原理、索引管理实现等；</p></blockquote>
<h2 id="一mysql索引机制概述">一、MySQL索引机制概述</h2>
<p>对于<code>MySQL</code>索引机制的作用，经过上述「新华字典」的案例后可得知：<strong>索引就是用来帮助表快速检索目标数据的</strong>。此时先来简单回顾一下<code>MySQL</code>中索引是如何使用的呢？首先需要创建索引，<code>MySQL</code>可以通过<code>CREATE、ALTER、DDL</code>三种方式创建一个索引。</p>
<h3 id="11mysql索引的创建方式">1.1、MySQL索引的创建方式</h3>
<ul>
<li>①使用<code>CREATE</code>语句创建</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">indexName</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">tableName</span><span class="w"> </span><span class="p">(</span><span class="n">columnName</span><span class="p">(</span><span class="k">length</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="k">ASC</span><span class="o">|</span><span class="k">DESC</span><span class="p">]);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这种创建方式可以给一张已存在的表结构添加索引，其中需要指定几个值：</p>
<ul>
<li><code>indexName</code>：当前创建的索引，创建成功后叫啥名字。</li>
<li><code>tableName</code>：要在哪张表上创建一个索引，这里指定表名。</li>
<li><code>columnName</code>：要为表中的哪个字段创建索引，这里指定字段名。</li>
<li><code>length</code>：如果字段存储的值过长，选用值的前多少个字符创建索引。</li>
<li><code>ASC|DESC</code>：指定索引的排序方式，<code>ASC</code>是升序，<code>DESC</code>是降序，默认<code>ASC</code>。</li>
</ul>
<p>当然，上述语句中的<code>INDEX</code>也可更改为<code>KEY</code>，作用都是创建一个普通索引，而对于其他的索引类型，这点在后续的索引分类中再聊。</p>
<ul>
<li>②使用<code>ALTER</code>语句创建</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tableName</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">indexName</span><span class="p">(</span><span class="n">columnName</span><span class="p">(</span><span class="k">length</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="k">ASC</span><span class="o">|</span><span class="k">DESC</span><span class="p">]);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这里的参数都相同，所以不再重复赘述。</p>
<ul>
<li>③建表时<code>DDL</code>语句中创建</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tableName</span><span class="p">(</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">columnName1</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">   
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">columnName2</span><span class="w"> </span><span class="p">....,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">.....,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">INDEX</span><span class="w"> </span><span class="p">[</span><span class="n">indexName</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">columnName</span><span class="p">(</span><span class="k">length</span><span class="p">))</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这种方式就比较适合在库表设计时，已经确定了索引项的情况下建立。</p>
<h3 id="12查询删除指定索引">1.2、查询、删除、指定索引</h3>
<p>但不管通过哪种方式建立索引，本质上创建的索引都是相同的，当索引创建完成后，可通过<code>SHOW INDEX FROM tableName;</code>这条命令查询一个表中拥有的索引，如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">zz_user</span><span class="o">`</span><span class="w">  </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">`</span><span class="n">user_id</span><span class="o">`</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">`</span><span class="n">user_name</span><span class="o">`</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">`</span><span class="n">user_sex</span><span class="o">`</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">`</span><span class="n">user_phone</span><span class="o">`</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">user_id</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">BTREE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ENGINE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InnoDB</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nb">CHARACTER</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">utf8</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">COLLATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">utf8_general_ci</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ROW_FORMAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Compact</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>在上述的建表<code>SQL</code>中，为<code>user_id</code>创建了一个主键索引，然后来查一下当前表的索引信息：
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./images/4ad9dbbda57c4d5dade247db392c4803tplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp"
        data-srcset="./images/4ad9dbbda57c4d5dade247db392c4803tplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp, ./images/4ad9dbbda57c4d5dade247db392c4803tplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp 1.5x, ./images/4ad9dbbda57c4d5dade247db392c4803tplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp 2x"
        data-sizes="auto"
        alt="./images/4ad9dbbda57c4d5dade247db392c4803tplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp"
        title="索引查询" />
简单的概述一下查询后，每个字段的含义：</p>
<ul>
<li>①<code>Table</code>：当前索引属于那张表。</li>
<li>②<code>Non_unique</code>：目前索引是否属于唯一索引，<code>0</code>代表是的，<code>1</code>代表不是。</li>
<li>③<code>Key_name</code>：当前索引的名字。</li>
<li>④<code>Seq_in_index</code>：如果当前是联合索引，目前字段在联合索引中排第几个。</li>
<li>⑤<code>Column_name</code>：当前索引是位于哪个字段上建立的。</li>
<li>⑥<code>Collation</code>：字段值以什么方式存储在索引中，<code>A</code>表示有序存储，<code>NULL</code>表无序。</li>
<li>⑦<code>Cardinality</code>：当前索引的散列程度，也就是索引中存储了多少个不同的值。</li>
<li>⑧<code>Sub_part</code>：当前索引使用了字段值的多少个字符建立，<code>NULL</code>表示全部。</li>
<li>⑨<code>Packed</code>：表示索引在存储字段值时，以什么方式压缩，<code>NULL</code>表示未压缩，</li>
<li>⑩<code>Null</code>：当前作为索引字段的值中，是否存在<code>NULL</code>值，<code>YES</code>表示存在。</li>
<li>⑪<code>Index_type</code>：当前索引的结构（<code>BTREE, FULLTEXT, HASH, RTREE</code>）。</li>
<li>⑫<code>Comment</code>：创建索引时，是否对索引有备注信息。</li>
</ul>
<p>这条命令在后续排除问题、性能调优时，会有不小的作用，比如可以通过分析其中的<code>Cardinality</code>字段值，如果该值少于数据的实际行数，那目前索引有可能失效（对于这些后续排查篇和<code>SQL</code>优化篇再聊）。</p>
<blockquote>
<p>OK~，到这里了解了一下索引相关的创建、查询命令，接着再看看删除、强制使用命令。</p></blockquote>
<p>在<code>MySQL</code>中并未提供修改索引的命令，也就说当你建错了索引，只能先删再重新建立一次，删除索引的语句如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DROP</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">indexName</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">tableName</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>当然，当建立了一条索引后，也可以强制性的为<code>SELECT</code>语句指定索引，如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table_name</span><span class="w"> </span><span class="k">FORCE</span><span class="w"> </span><span class="k">INDEX</span><span class="p">(</span><span class="n">index_name</span><span class="p">)</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="p">.....;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><code>FORCE INDEX</code>关键字可以为一条查询语句强制指定走哪个索引查询，但要牢记的是：<strong>如果当前的查询<code>SQL</code>压根不会走指定的索引字段，哪这种方式是行不通的</strong>，这个关键字的用法是：一条查询语句在有多个索引可以检索数据时，显式指定一个索引，减少优化器选择索引的耗时。</p>
<blockquote>
<p>但要注意：如果你对于你整个业务系统十分熟悉，那可以这样干。但如果不熟悉的话，还是交给优化器来自行选择，否则会适得其反！</p></blockquote>
<h3 id="13数据库索引的本质">1.3、数据库索引的本质</h3>
<p>前面一直在聊创建、查看、删除、指定等一些索引的基本操作，但索引本质上在数据库中是什么呢？大家都知道，数据库是基于磁盘工作的，所有的数据都会放到磁盘上存储，而索引也是数据的一种，因此与表数据相同，最终创建出的索引也会在磁盘生成本地文件。</p>
<p>不过索引文件在磁盘中究竟以何种方式存储，这是由索引的数据结构来决定的。同时，由于索引机制最终是由存储引擎实现，因此不同存储引擎下的索引文件，其保存在本地的格式也并不相同。</p>
<blockquote>
<p>在这里有一个点需要注意：建立索引的工作在表数据越少时越好，如果你想要给一张百万、千万条数据级别的表新创建一个索引，那创建的耗时也不短，这是为什么呢？</p></blockquote>
<p>因为刚刚聊过，索引本质上和表是一样的，都是磁盘中的文件，那也就代表着创建一个索引，并不像单纯的给一张表加个约束那么简单，而是会基于原有的表数据，重新在磁盘中创建新的本地索引文件。假设表中有一千万条数据，那创建索引时，就需要将索引字段上的<code>1000W</code>个值全部拷贝到本地索引文件中，同时做好排序并与表数据产生映射关系。</p>
<blockquote>
<p>OK~，至此就对<code>MySQL</code>提供的索引机制做了简单回顾，下面再来说说数据库中“多样化”的索引类型。</p></blockquote>
<h2 id="二mysql的索引分类">二、MySQL的索引分类</h2>
<p>在前面我为什么用多样化去形容数据库索引呢？因为确实如此，先列一些大家都听说过的索引称呼：聚簇索引、非聚簇索引、唯一索引、主键索引、联合索引、全文索引、单列索引、多列索引、复合索引、普通索引、二级索引、辅助索引、次级索引、有序索引、<code>B+Tree</code>索引、<code>R-Tree</code>索引、<code>T-Tree</code>索引、<code>Hash</code>索引、空间索引、前缀索引&hellip;&hellip;</p>
<blockquote>
<p>是不是看的眼花缭乱，这些都是<code>MySQL</code>中索引的一些称呼，一通看下来，估计大家看“索引”两个字都有点不认识了<code>^_^</code></p></blockquote>
<p>但实际上<code>MySQL</code>中真的有这么多索引类型吗？其实并没有，上述列出的索引称呼中，有几个称呼对应的索引是同一个，有一部分只是逻辑上的索引，那索引究竟该如何分类呢？其实从不同的层面上来说，可以将索引划分为不同的类型，接下来重点聊一聊。</p>
<h3 id="21数据结构层次">2.1、数据结构层次</h3>
<p>前面聊索引本质的时候提到过，索引建立后也会在磁盘生成索引文件，那每个具体的索引节点该如何在本地文件中存放呢？这点是由索引的数据结构来决定的。比如索引的底层结构是数组，那所有的索引节点都会以<code>Node1→Node2→Node3→Node4....</code>这样的形式，存储在磁盘同一块物理空间中，不过<code>MySQL</code>的索引不支持数组结构，或者说数组结构不适合作为索引结构，<code>MySQL</code>索引支持的数据结构如下：</p>
<ul>
<li><code>B+Tree</code>类型：<code>MySQL</code>中最常用的索引结构，大部分引擎支持，有序。</li>
<li><code>Hash</code>类型：大部分存储引擎都支持，字段值不重复的情况下查询最快，无序。</li>
<li><code>R-Tree</code>类型：<code>MyISAM</code>引擎支持，也就是空间索引的默认结构类型。</li>
<li><code>T-Tree</code>类型：<code>NDB-Cluster</code>引擎支持，主要用于<code>MySQL-Cluster</code>服务中。</li>
</ul>
<p>在上述的几种索引结构中，<code>B+</code>树和哈希索引是最常见的索引结构，几乎大部分存储引擎都实现了，对于后续两种索引结构在某些情况下也较为常见，但除开列出的几种索引结构外，<code>MySQL</code>索引支持的数据结构还有<code>R+、R*、QR、SS、X</code>树等结构。</p>
<blockquote>
<p>但为何后续的一些索引结构大家没听说过呢？这是因为索引到底支持什么数据结构，这是由存储引擎决定的，不同的存储引擎支持的索引结构也并不同，目前较为常用的引擎就是<code>MyISAM、InnoDB</code>，因此大家未曾听说后面列出的这些索引结构也是正常的。</p></blockquote>
<p>当然，也正因为索引结构由存储引擎决定，而<code>MySQL</code>引擎层在<a href="https://juejin.cn/post/7143614079532269598#heading-10" target="_blank" rel="noopener noreffer ">《MySQL架构篇》</a>中提到过，属于可拔插式引擎，所以如果你有能力自己实现一个引擎，那你甚至可以让引擎的索引机制支持任何数据结构。</p>
<blockquote>
<p>在<code>MySQL</code>中创建索引时，其默认的数据结构就为<code>B+Tree</code>，如何更换索引的数据结构呢？如下：</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">indexName</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">tableName</span><span class="w"> </span><span class="p">(</span><span class="n">columnName</span><span class="p">(</span><span class="k">length</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="k">ASC</span><span class="o">|</span><span class="k">DESC</span><span class="p">])</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">HASH</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>也就是在创建索引时，通过<code>USING</code>关键字显示指定索引的数据结构（必须要为当前引擎支持的结构）。</p>
<p>同时索引会被分为有序索引和无序索引，这是指索引文件中存储索引节点时，会不会按照字段值去排序。那一个索引到底是有序还是无序，就是依据数据结构决定的，例如<code>B+Tree、R-Tree</code>等树结构都是有序，而哈希结构则是无序的。</p>
<h3 id="22字段数量层次">2.2、字段数量层次</h3>
<p>前面从索引的数据结构层次出发，可以将索引分为不同结构的类型，而从表字段的层次来看，索引又可以分为单列索引和多列索引，这两个称呼也比较好理解，单列索引是指索引是基于一个字段建立的，多列索引则是指由多个字段组合建立的索引。</p>
<p>单列索引也会分为很多类型，比如：</p>
<ul>
<li>唯一索引：指索引中的索引节点值不允许重复，一般配合唯一约束使用。</li>
<li>主键索引：主键索引是一种特殊的唯一索引，和普通唯一索引的区别在于不允许有空值。</li>
<li>普通索引：通过<code>KEY、INDEX</code>关键字创建的索引就是这个类型，没啥限制，单纯的可以让查询快一点。</li>
<li>&hellip;..还有很多很多，只要是基于单个字段建立的索引都可以被称为单列索引。</li>
</ul>
<p>多列索引的概念前面解释过了，不过它也有很多种叫法，例如：</p>
<ul>
<li>组合索引、联合索引、复合索引、多值索引&hellip;.</li>
</ul>
<p>但不管名称咋变，描述的含义都是相同的，即由多个字段组合建立的索引。</p>
<blockquote>
<p>不过在使用多列索引时要注意：当建立多列索引后，一条<code>SELECT</code>语句，只有当查询条件中了包含了多列索引的第一个字段时，才能使用多列索引，下面举个栗子。</p></blockquote>
<p>比如在用户表中，通过<code>id、name、age</code>三个字段建立一个多列索引，什么情况下会使用索引，什么时候不会呢？如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- 无法使用多列索引的SQL语句
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="o">`</span><span class="n">zz_user</span><span class="o">`</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;竹子&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;18&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 能命中多列索引的SQL语句
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="o">`</span><span class="n">zz_user</span><span class="o">`</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;竹子&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>OK，到这里就根据字段数量的层面出发，简单讲明了单列和多列索引的概念，但无论是单列还是多列，都可以存在一个前缀索引的概念，啥叫前缀索引呢？还记得创建索引时指定的<code>length</code>字段吗？</p>
<ul>
<li><code>length</code>：如果字段存储的值过长，选用值的前多少个字符创建索引。</li>
</ul>
<p>使用一个字段值中的前<code>N</code>个字符创建出的索引，就可以被称为前缀索引，前缀索引能够在很大程度上，节省索引文件的存储空间，也能很大程度上提升索引的性能，这是为什么呢？后面分析索引实现原理的时候细聊。</p>
<h3 id="23功能逻辑层次">2.3、功能逻辑层次</h3>
<p>相信大家在面试时，如果问到了<code>MySQL</code>索引机制，相信一定会问如下这道面试题：</p>
<blockquote>
<p>请回答一下你知道的<code>MySQL</code>索引类型。</p></blockquote>
<p>这题的答案该怎么回答呢？其实主要就是指<code>MySQL</code>索引从逻辑上可以分为那些类型，以功能逻辑划分索引类型，这也是最常见的划分方式，从这个维度来看主要可划分为五种：</p>
<ul>
<li>普通索引、唯一索引、主键索引、全文索引、空间索引</li>
</ul>
<p>对于普通索引、唯一索引、主键索引都介绍过了，就不再过多阐述，但稍微提一嘴，在主键字段上建立的索引被称为主键索引，非主键字段上建立的索引一般被称为辅助索引或、二级索引或次级索引，接着重点聊一下全文索引和空间索引。</p>
<p>全文索引和空间索引都是<code>MySQL5.7</code>版本后开始支持的索引类型，不过这两种索引都只有<code>MyISAM</code>引擎支持，其他引擎要么我没用过，要么就由于自身实现的原因不支持，例如<code>InnoDB</code>。对于全文索引而言，其实在<code>MySQL5.6</code>版本中就有了，但当时并不支持汉字检索，到了<code>5.7.6</code>版本的时候才内嵌<code>ngram</code>全文解析器，才支持亚洲语种的分词，同时<code>InnoDB</code>引擎也开始支持全文索引，在<code>5.7</code>版本之前，只有<code>MyISAM</code>引擎支持。</p>
<h4 id="全文索引">全文索引</h4>
<p>全文索引类似于<code>ES、Solr</code>搜索中间件中的分词器，或者说和之前常用的<code>like+%</code>模糊查询很类似，它只能创建在<code>CHAR、VARCHAR、TEXT</code>等这些文本类型字段上，而且使用全文索引查询时，条件字符数量必须大于<code>3</code>才生效。当然，还是举个栗子才有感觉：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">+</span><span class="c1">------------+--------------------------------------------+------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">article_id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">article_name</span><span class="w">                               </span><span class="o">|</span><span class="w"> </span><span class="n">special_column</span><span class="w">   </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------+--------------------------------------------+------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">          </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">MySQL架构篇</span><span class="err">：自顶向下深入剖析</span><span class="n">MySQL整体架构</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">《全解</span><span class="n">MySQL</span><span class="err">》</span><span class="w">    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">          </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">MySQL执行篇</span><span class="err">：一条</span><span class="n">SQL语句从诞生至结束的历程</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">《全解</span><span class="n">MySQL</span><span class="err">》</span><span class="w">    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">          </span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">MySQL设计篇</span><span class="err">：数据库六范式与反范式设计准则！</span><span class="o">|</span><span class="w"> </span><span class="err">《全解</span><span class="n">MySQL</span><span class="err">》</span><span class="w">    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">          </span><span class="mi">4</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">MySQL索引篇</span><span class="err">：索引概述、分类及建立索引的原则</span><span class="o">|</span><span class="w"> </span><span class="err">《全解</span><span class="n">MySQL</span><span class="err">》</span><span class="w">    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------+--------------------------------------------+------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>比如现在用户想要搜索一篇文章，但是忘记文章全称了，只记得「诞生至结束」这个词汇，此时用户搜索这个词汇，走全文索引的情况下，照样能够定位到上表中的第二条记录。</p>
<blockquote>
<p>当然，全文索引如何创建与使用，待会儿后面一起列出来。</p></blockquote>
<h4 id="空间索引">空间索引</h4>
<p>空间索引这玩意儿其实用的不多，至少大部分项目的业务中不会用到，想要弄清楚空间索引，那么首先得知道一个概念：<code>GIS</code>空间数据，<code>GIS</code>是什么意思呢？是地理信息系统，这是一门新的学科，基于了计算机、信息学、地理学等多科构建的，主要就是用于管理地理信息的数据结构，在国土、规划、出行、配送、地图等和地理有关的项目中，应用较为频繁。</p>
<p>地理空间数据主要包含矢量数据、3D模型、影像文件、坐标数据等，说简单点，空间数据也就是可以将地理信息以模型的方式，在地图上标注出来。在<code>MySQL</code>中总共支持<code>GEOMETRY、POINT、LINESTRING、POLYGON</code>四种空间数据类型，而空间索引则是基于这些类型的字段建立的，也就是可以帮助我们快捷检索空间数据。</p>
<blockquote>
<p>不过对于空间索引，一般用的较少，大家了解即可。</p></blockquote>
<h3 id="24存储方式层次">2.4、存储方式层次</h3>
<p>上面聊完了三种不同层次的索引划分后，接着从存储方式的层面再聊聊，从存储方式来看，<code>MySQL</code>的索引主要可分为两大类：</p>
<ul>
<li>聚簇索引：也被称为聚集索引、簇类索引</li>
<li>非聚簇索引：也叫非聚集索引、非簇类索引、二级索引、辅助索引、次级索引</li>
</ul>
<p>重点说一说这两类索引存储方式的区别，在说之前先回忆一下数组和链表的区别：</p>
<ul>
<li>数组是物理空间上的连续，存储的所有元素都会按序存放在同一块内存区域中。</li>
<li>链表是逻辑上的连续，存储的所有元素可能不在同一块内存，元素之间以指针连接。</li>
</ul>
<p>为啥要说这个呢？因为聚簇索引和非聚簇索引的区别也大致是相同的：</p>
<ul>
<li>聚簇索引：逻辑上连续且物理空间上的连续。</li>
<li>非聚簇索引：逻辑上的连续，物理空间上不连续。</li>
</ul>
<p>当然，这里的连续和数组不同，因为索引大部分都是使用<code>B+Tree</code>结构存储，所以在磁盘中数据是以树结构存放的，所以连续并不是指索引节点，而是指索引数据和表数据，也就是说聚簇索引中，索引数据和表数据在磁盘中的位置是一起的，而非聚簇索引则是分开的，索引节点和表数据之间，用物理地址的方式维护两者的联系。</p>
<p>不过一张表中只能存在一个聚簇索引，一般都会选用主键作为聚簇索引，其他字段上建立的索引都属于非聚簇索引，或者称之为辅助索引、次级索引。但也不要走进一个误区，虽然<code>MySQL</code>默认会使用主键上建立的索引作为聚簇索引，但也可以指定其他字段上的索引为聚簇索引，一般聚簇索引要求索引必须是非空唯一索引才行。</p>
<blockquote>
<p>其实就算表中没有定义主键，<code>InnoDB</code>中会选择一个唯一的非空索引作为聚簇索引，但如果非空唯一索引也不存在，<code>InnoDB</code>隐式定义一个主键来作为聚簇索引。</p></blockquote>
<p>当然，主键或者说聚簇索引，一般适合采用带有自增性的顺序值。</p>
<blockquote>
<p>对于聚簇、非聚簇索引的区别、两者的查找过程、隐式主键、为何主键适合自增值等这些问题，在后续的《索引原理篇》中会详细讲解。</p></blockquote>
<h3 id="25索引分类小结">2.5、索引分类小结</h3>
<p>至此，对于<code>MySQL</code>“多样化”的索引机制，一大堆索引名词，就已经梳理清楚啦！相信到这里为止，大家也对<code>MySQL</code>的索引机制有了系统化的认知，其实最开始给出的一大堆索引名词，只是从不同角度划分出来的，在上述中分别从数据结构、字段数量、功能逻辑以及存储方式多个层面进行了描述。当然，要牢记的是，以功能逻辑的层次来划分索引，这也是最常用的方式。</p>
<h2 id="三mysql其他索引的创建使用方式">三、MySQL其他索引的创建使用方式</h2>
<p>前面的案例中，聊到了咱们有三种方式创建索引，在创建时可通过<code>INDEX、KEY</code>两个关键字创建，但这种方式建立的索引仅是普通索引，接着再来聊一聊<code>MySQL</code>数据库其他类型的索引该如何创建以及使用。</p>
<blockquote>
<p>但不管是何种类型的索引，都可以通过前面聊到的三种方式创建。</p></blockquote>
<h3 id="31唯一索引的创建与使用">3.1、唯一索引的创建与使用</h3>
<p>唯一索引在创建时，需要通过<code>UNIQUE</code>关键字创建：如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- 方式①
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">indexName</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">tableName</span><span class="w"> </span><span class="p">(</span><span class="n">columnName</span><span class="p">(</span><span class="k">length</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 方式②
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tableName</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">indexName</span><span class="p">(</span><span class="n">columnName</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 方式③
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tableName</span><span class="p">(</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">columnName1</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">   
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">columnName2</span><span class="w"> </span><span class="p">....,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">.....,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="p">[</span><span class="n">indexName</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">columnName</span><span class="p">(</span><span class="k">length</span><span class="p">))</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>在已有的表基础上创建唯一索引时要注意，如果选用的字段，表中字段的值存在相同值时，这时唯一索引是无法创建的，比如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="o">`</span><span class="n">zz_article</span><span class="o">`</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------+--------------------------+-------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">article_id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">article_name</span><span class="w">             </span><span class="o">|</span><span class="w"> </span><span class="n">special_column</span><span class="w">    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------+--------------------------+-------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">          </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">MySQL架构篇</span><span class="err">：</span><span class="p">.......</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="err">《全解</span><span class="n">MySQL</span><span class="err">》</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">          </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">MySQL执行篇</span><span class="err">：</span><span class="p">.......</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="err">《全解</span><span class="n">MySQL</span><span class="err">》</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">          </span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">MySQL设计篇</span><span class="err">：</span><span class="p">.......</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="err">《全解</span><span class="n">MySQL</span><span class="err">》</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">          </span><span class="mi">4</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">MySQL索引篇</span><span class="err">：</span><span class="p">.......</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="err">《全解</span><span class="n">MySQL</span><span class="err">》</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">          </span><span class="mi">5</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">MySQL索引篇</span><span class="err">：</span><span class="p">.......</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="err">《全解</span><span class="n">MySQL</span><span class="err">》</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------+--------------------------+-------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">i_article_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">zz_article</span><span class="w"> </span><span class="p">(</span><span class="n">article_name</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>比如上述文章表中，第<code>4、5</code>条数据是重复的，此时创建利用<code>SQL</code>语句创建唯一索引，就会抛出<code>1062</code>错误码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">ERROR</span><span class="w"> </span><span class="mi">1062</span><span class="w"> </span><span class="p">(</span><span class="mi">23000</span><span class="p">):</span><span class="w"> </span><span class="n">Duplicate</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="s1">&#39;MySQL索引篇：.......&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="s1">&#39;i_article_name&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>在这种情况下，就只能先删除重复数据，然后才能创建唯一索引成功。</p></blockquote>
<p>同时，当唯一索引创建成功后，它同时会对表具备唯一约束的作用，当再使用<code>INSERT</code>语句插入相同值时，会同样会抛出<code>1062</code>错误码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="o">`</span><span class="n">zz_article</span><span class="o">`</span><span class="w"> </span><span class="k">VALUES</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s2">&#34;MySQL索引篇：.......&#34;</span><span class="p">,</span><span class="s2">&#34;《全解MySQL》&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">1062</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Duplicate</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="s1">&#39;MySQL索引篇：.......&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="s1">&#39;i_article_name&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这里会提示你插入的哪个值，已经在表中存在，因此无法插入当前这条数据。</p>
<h3 id="32主键索引的创建与使用">3.2、主键索引的创建与使用</h3>
<p>前面聊到过，主键索引其实是一种特殊的唯一索引，但主键索引却并不是通过<code>UNIQUE</code>关键字创建的，而是通过<code>PRIMARY</code>关键字创建：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- 方式①
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tableName</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">indexName</span><span class="p">(</span><span class="n">columnName</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 方式②
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tableName</span><span class="p">(</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">columnName1</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">   
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">columnName2</span><span class="w"> </span><span class="p">....,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">.....,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">[</span><span class="n">indexName</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">columnName</span><span class="p">(</span><span class="k">length</span><span class="p">))</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>在这里要注意：</p>
<ul>
<li>创建主键索引时，必须要将索引字段先设为主键，否则会抛<code>1068</code>错误码。</li>
<li>这里也不能使用<code>CREATE</code>语句创建索引，否则会提示<code>1064</code>语法错误。</li>
<li>同时创建索引时，关键字要换成<code>KEY</code>，并非<code>INDEX</code>，否则也会提示语法错误。</li>
</ul>
<p>还是以之前的文章表为例，如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- 对非主键字段创建主键索引
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">zz_article</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">i_special_column</span><span class="p">(</span><span class="n">special_column</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 报错信息如下：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">1068</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Multiple</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="k">defined</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 使用CREATE关键字创建主键索引
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">i_article_id</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">zz_article</span><span class="w"> </span><span class="p">(</span><span class="n">article_id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 报错信息如下：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">1064</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">You</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="n">syntax</span><span class="p">;</span><span class="w"> </span><span class="k">check</span><span class="p">....</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 使用INDEX关键字创建索引
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">zz_article</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">i_article_id</span><span class="p">(</span><span class="n">article_id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 报错信息如下：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">1064</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">You</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="n">syntax</span><span class="p">;</span><span class="w"> </span><span class="k">check</span><span class="p">....</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 创建主键索引正确的方式
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">zz_article</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">i_article_id</span><span class="p">(</span><span class="n">article_id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>当然，一般主键索引都会在建表的<code>DDL</code>语句中创建，不会在表已经建立后再创建。</p>
<p>但似乎无论在讲普通索引，还是唯一索引、主键索引的时候，我们都没有讲如何使用这些创建好的索引查询数据，其实这一点无需咱们考虑，参考之前<a href="https://juejin.cn/post/7145102393988874253" target="_blank" rel="noopener noreffer ">《SQL执行篇》</a>中查询语句的执行流程，在一条<code>SELECT</code>语句来到<code>MySQL</code>时，会经历优化器优化的过程，而优化器则会自动帮咱们选择一个最合适的索引查询数据。当然，前提是查询条件中涉及到了索引字段才行。</p>
<blockquote>
<p>前面也说过，你不想让优化器自动选择，也可以手动通过<code>FORCE INDEX</code>关键字强制指定。</p></blockquote>
<h3 id="33全文索引的创建与使用">3.3、全文索引的创建与使用</h3>
<p>全文索引和其他索引不同，首先如果你想要创建全文索引，那么<code>MySQL</code>版本必须要在<code>5.7</code>及以上，同时使用时也需要手动指定，一起来先看看如何创建全文索引，此时需要使用<code>FULLTEXT</code>关键字：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- 方式①
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tableName</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="n">FULLTEXT</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">indexName</span><span class="p">(</span><span class="n">columnName</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 方式②
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="n">FULLTEXT</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">indexName</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">tableName</span><span class="p">(</span><span class="n">columnName</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>不过在创建全文索引时，有三个注意点：</p>
<ul>
<li><code>5.6</code>版本的<code>MySQL</code>中，存储引擎必须为<code>MyISAM</code>才能创建。</li>
<li>创建全文索引的字段，其类型必须要为<code>CHAR、VARCHAR、TEXT</code>等文本类型。</li>
<li>如果想要创建出的全文索引支持中文，需要在最后指定解析器：<code>with parser ngram</code>。</li>
</ul>
<p>此时还依旧是以文章表为例，为文章名称字段创建一个全文索引，命令如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">zz_article</span><span class="w"> </span><span class="k">ADD</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">FULLTEXT</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ft_article_name</span><span class="p">(</span><span class="n">article_name</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WITH</span><span class="w"> </span><span class="n">PARSER</span><span class="w"> </span><span class="n">NGRAM</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>创建好全文索引后，当你想要使用全文索引时，优化器这时不能自动选择，因为全文索引有自己的语法，但在了解如何使用之前，得先清楚两个概念：最小搜索长度和最大搜索长度，先来看看全文索引的一些参数，可通过<code>show variables like '%ft%';</code>命令查询，如下：
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./images/15843b9707f6416bb5da7e7f22fe039ftplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp"
        data-srcset="./images/15843b9707f6416bb5da7e7f22fe039ftplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp, ./images/15843b9707f6416bb5da7e7f22fe039ftplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp 1.5x, ./images/15843b9707f6416bb5da7e7f22fe039ftplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp 2x"
        data-sizes="auto"
        alt="./images/15843b9707f6416bb5da7e7f22fe039ftplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp"
        title="全文索引参数" />
多余的参数就不介绍了，重点讲一下其中的几个重要参数：</p>
<ul>
<li><code>ft_min_word_len</code>：使用<code>MyISAM</code>引擎的表中，全文索引最小搜索长度。</li>
<li><code>ft_max_word_len</code>：使用<code>MyISAM</code>引擎的表中，全文索引最大搜索长度。</li>
<li><code>ft_query_expansion_limit</code>：<code>MyISAM</code>中使用<code>with query expansion</code>搜索的最大匹配数。</li>
<li><code>innodb_ft_min_token_size</code>：<code>InnoDB</code>引擎的表中，全文索引最小搜索长度。</li>
<li><code>innodb_ft_max_token_size</code>：<code>InnoDB</code>引擎的表中，全文索引最大搜索长度。</li>
</ul>
<p>那么究竟做最小搜索长度、最大搜索长度的作用是什么呢？其实这个是一个限制，对于长度小于最小搜索长度和大于最大搜索长度的词语，都无法触发全文索引。也就是说，如果想要使用全文索引对一个词语进行搜索，那这个词语的长度必须在这两个值之间。</p>
<blockquote>
<p>其实这两个值自己可以手动调整的，最小值可以手动调整为<code>1</code>，<code>MyISAM</code>引擎的最大值可以调整为<code>3600</code>，但<code>InnoDB</code>引擎最大似乎就是<code>84</code>。</p></blockquote>
<p>OK~，了解全文索引中的一些概念后，接下来看看如何使用全文索引，全文索引中有两个专门用于检索的关键字，即<code>MATCH(column)、AGAINST(关键字)</code>，同时这两个检索函数也支持三种搜索模式：</p>
<ul>
<li>自然语言模式(默认搜索模式)</li>
<li>布尔搜索模式</li>
<li>查询拓展搜索</li>
</ul>
<p><code>MATCH()</code>主要是负责指定要搜索的列，这里要指定创建全文索引的字段，<code>AGAINST()</code>则指定要搜索的关键字，也就是要搜索的词语，接下来简单的讲一下三种搜索模式。</p>
<h4 id="自然语言模式">自然语言模式</h4>
<p>这种模式也是在使用全文索引时，默认的搜索模式，使用方法如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">+</span><span class="c1">------------+--------------------------+-------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">article_id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">article_name</span><span class="w">             </span><span class="o">|</span><span class="w"> </span><span class="n">special_column</span><span class="w">    </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------+--------------------------+-------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">          </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">MySQL架构篇</span><span class="err">：</span><span class="p">.......</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="err">《全解</span><span class="n">MySQL</span><span class="err">》</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">          </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">MySQL执行篇</span><span class="err">：</span><span class="p">.......</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="err">《全解</span><span class="n">MySQL</span><span class="err">》</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">          </span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">MySQL设计篇</span><span class="err">：</span><span class="p">.......</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="err">《全解</span><span class="n">MySQL</span><span class="err">》</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">          </span><span class="mi">4</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">MySQL索引篇</span><span class="err">：</span><span class="p">.......</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="err">《全解</span><span class="n">MySQL</span><span class="err">》</span><span class="w">     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">------------+--------------------------+-------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="n">article_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s1">&#39;搜索结果数量&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">`</span><span class="n">zz_article</span><span class="o">`</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">MATCH</span><span class="p">(</span><span class="n">article_name</span><span class="p">)</span><span class="w"> </span><span class="n">AGAINST</span><span class="p">(</span><span class="s1">&#39;MySQL&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 运行结果如下：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">+</span><span class="c1">--------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="err">搜索结果数量</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">--------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w">           </span><span class="mi">4</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">--------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>一眼看过去，<code>SQL</code>就能看懂，毕竟都可以排版了一下<code>SQL</code>，不过多介绍了。唯一要注意的是，如果给定的关键词长度小于默认的最小搜索长度，那是无法使用全文索引的，比如下述这条<code>SQL</code>就不会触发：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="n">article_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s1">&#39;搜索结果数量&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">`</span><span class="n">zz_article</span><span class="o">`</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">MATCH</span><span class="p">(</span><span class="n">article_name</span><span class="p">)</span><span class="w"> </span><span class="n">AGAINST</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="布尔搜索模式">布尔搜索模式</h4>
<p>布尔搜索模式有些特殊，因为在这种搜索模式中，还需要掌握特定的搜索语法：</p>
<ul>
<li>
<p><code>+</code>：表示必须匹配的行数据必须要包含相应关键字。</p>
</li>
<li>
<p><code>-</code>：和上面的<code>+</code>相反，表示匹配的数据不能包含相应的关键字。</p>
</li>
<li>
<p><code>&gt;</code>：提升指定关键字的相关性，在查询结果中靠前显示。</p>
</li>
<li>
<p><code>&lt;</code>：降低指定关键字的相关性，在查询结果中靠后显示。</p>
</li>
<li>
<p><code>~</code>：表示允许出现指定关键字，但出现时相关性为负。</p>
</li>
<li>
<p><code>*</code>：表示以该关键字开头的词语，如<code>A*</code>，可以匹配<code>A、AB、ABC....</code></p>
</li>
<li>
<p><code>&quot;&quot;</code>：双引号中的关键字作为整体，检索时不允许再分词。</p>
</li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#34;X Y&#34;@n
</span></span></code></pre></td></tr></table>
</div>
</div><p>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#34;&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>包含的多个词语之间的距离必须要在</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">n
</span></span></code></pre></td></tr></table>
</div>
</div><p>之间，单位-字节，如：</p>
<ul>
<li><code>竹子 熊猫@10</code>：表示竹子和熊猫两个词语之间的距离要在<code>10</code>字节内。</li>
</ul>
</li>
<li>
<p>&hellip;&hellip;.</p>
</li>
</ul>
<p>举个几个例子使用一下，如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- 查询文章名中包含 [MySQL] 但不包含 [设计] 的数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">`</span><span class="n">zz_article</span><span class="o">`</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">MATCH</span><span class="p">(</span><span class="n">article_name</span><span class="p">)</span><span class="w"> </span><span class="n">AGAINST</span><span class="p">(</span><span class="s1">&#39;+MySQL -设计&#39;</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">MODE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 查询文章名中包含 [MySQL] 和 [篇] 的数据，但两者间的距离不能超过10字节
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">`</span><span class="n">zz_article</span><span class="o">`</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">MATCH</span><span class="p">(</span><span class="n">article_name</span><span class="p">)</span><span class="w"> </span><span class="n">AGAINST</span><span class="p">(</span><span class="s1">&#39;&#34;MySQL 篇&#34;@10&#39;</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">MODE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 查询文章名中包含[MySQL] 的数据，
</span></span></span><span class="line"><span class="cl"><span class="c1">--    但包含 [执行] 关键字的行相关性要高于包含 [索引] 关键字的行数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">`</span><span class="n">zz_article</span><span class="o">`</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">MATCH</span><span class="p">(</span><span class="n">article_name</span><span class="p">)</span><span class="w"> </span><span class="n">AGAINST</span><span class="p">(</span><span class="s1">&#39;+MySQL +(&gt;执行 &lt;索引)&#39;</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">MODE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 查询文章名中包含 [MySQL] 的数据，但包含 [设计] 时则将相关性降为负
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">`</span><span class="n">zz_article</span><span class="o">`</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">MATCH</span><span class="p">(</span><span class="n">article_name</span><span class="p">)</span><span class="w"> </span><span class="n">AGAINST</span><span class="p">(</span><span class="s1">&#39;+MySQL ~设计&#39;</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">MODE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 查询文章名中包含 [执行] 关键字的行数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">`</span><span class="n">zz_article</span><span class="o">`</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">MATCH</span><span class="p">(</span><span class="n">article_name</span><span class="p">)</span><span class="w"> </span><span class="n">AGAINST</span><span class="p">(</span><span class="s1">&#39;执行*&#39;</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">MODE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 查询文章名中必须要包含 [MySQL架构篇] 关键字的数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">`</span><span class="n">zz_article</span><span class="o">`</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">MATCH</span><span class="p">(</span><span class="n">article_name</span><span class="p">)</span><span class="w"> </span><span class="n">AGAINST</span><span class="p">(</span><span class="s1">&#39;&#34;MySQL架构篇&#34;&#39;</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">MODE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>同样的，上述的<code>SQL</code>语句应该都能看明白，最后的<code>IN BOOLEAN MODE</code>表示使用布尔搜索模式，除此外，大家唯一疑惑的就在于：相关性这个词，其实这个词也不难理解，就是检索数据后，数据的优先级顺序，当相关性越高，对应数据在结果中越靠前，当相关性为负，则相应的数据排到最后。</p>
<h4 id="查询拓展搜索">查询拓展搜索</h4>
<p>查询拓展搜索其实是对自然语言搜索模式的拓展，比如举个例子：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="n">article_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s1">&#39;搜索结果数量&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">`</span><span class="n">zz_article</span><span class="o">`</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">MATCH</span><span class="p">(</span><span class="n">article_name</span><span class="p">)</span><span class="w"> </span><span class="n">AGAINST</span><span class="p">(</span><span class="s1">&#39;MySQL&#39;</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="n">EXPANSION</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>在自然语言模式的查询语句基础上，最后面多加一个<code>WITH QUERY EXPANSION</code>表示使用查询拓展搜索，这种模式下会比自然语言模式多一次检索过程，比如上述的例子中：</p>
<ul>
<li>首先会根据指定的关键字<code>MySQL</code>进行一次全文检索。</li>
<li>然后第二阶段还会对指定的关键进行分词，然后再进行一次全文检索。</li>
</ul>
<p>之前介绍全文索引参数时，也列出来了一个名为<code>ft_query_expansion_limit</code>的参数，这个参数就是控制拓展搜索时的拓展行数的，最大可以调整到<code>1000</code>。但由于<code>Query Expansion</code>的全文检索可能带来许多非相关性的查询结果，因此在实际情况中要慎用！！！</p>
<blockquote>
<p>实际上，全文索引引入<code>MySQL</code>后，可以用它代替之前的<code>like%</code>模糊查询，效率会更高。</p></blockquote>
<h3 id="34空间索引的创建与使用">3.4、空间索引的创建与使用</h3>
<p>空间索引这玩意儿实际上很多项目不会用到，我用的次数也不多，但如果你要用到这个索引，那可以通过<code>SPATIAL</code>关键字创建，如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tableName</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="n">SPATIAL</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">indexName</span><span class="p">(</span><span class="n">columnName</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>但在创建空间索引的时候，有几个注意点需要牢记：</p>
<ul>
<li>目前<code>MySQL</code>常用引擎中，仅有<code>MyISAM</code>支持空间索引，所以表引擎必须要为它。</li>
<li>空间索引必须要建立在类型为<code>GEOMETRY、POINT、LINESTRING、POLYGON</code>的字段上。</li>
</ul>
<blockquote>
<p>这个用的较少，就不展开细聊了~</p></blockquote>
<h3 id="35联合索引的创建与使用">3.5、联合索引的创建与使用</h3>
<p>联合索引呢，实际上并不是一种逻辑索引分类，它是索引的一种特殊结构，前面给出的所有案例中，都仅仅是在单个字段的基础上建立索引，而联合索引的意思是可以使用多个字段建立索引。那该如何创建联合索引呢，不需要特殊的关键字，方法如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">indexName</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">tableName</span><span class="w"> </span><span class="p">(</span><span class="n">column1</span><span class="p">(</span><span class="k">length</span><span class="p">),</span><span class="n">column2</span><span class="p">...);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tableName</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">indexName</span><span class="p">(</span><span class="n">column1</span><span class="p">(</span><span class="k">length</span><span class="p">),</span><span class="n">column2</span><span class="p">...);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">复制代码</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>你可以使用<code>INDEX</code>关键字，让多个列组成一个普通联合索引</li>
<li>也可以使用<code>UNIQUE INDEX</code>关键字，让多个列组成一个唯一联合索引</li>
<li>甚至还可以使用<code>FULLTEXT INDEX</code>关键字，让多个列组成一个全文联合索引</li>
<li>&hellip;&hellip;.</li>
</ul>
<p>但是前面也提过，<code>SELECT</code>语句的查询条件中，必须包含组成联合索引的第一个字段，此时才会触发联合索引，否则是无法使用联合索引的。</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2022-11-26</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8/">索引使用</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/java%E5%88%A4%E6%96%AD%E5%AD%97%E7%AC%A6%E4%B8%B2string%E6%98%AF%E5%90%A6%E4%B8%BA%E7%A9%BA/" class="prev" rel="prev" title="Java判断字符串String是否为空"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Java判断字符串String是否为空</a>
            <a href="/posts/%E5%BB%BA%E7%AB%8B%E7%B4%A2%E5%BC%95%E7%9A%84%E6%AD%A3%E7%A1%AE%E5%A7%BF%E5%8A%BF%E4%B8%8E%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95%E7%9A%84%E6%9C%80%E4%BD%B3%E6%8C%87%E5%8D%97/" class="next" rel="next" title="建立索引的正确姿势与使用索引的最佳指南">建立索引的正确姿势与使用索引的最佳指南<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="valine" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/">Valine</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.147.7">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.0"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2021 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">xxxx</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/valine/valine.min.css"><script type="text/javascript" src="/lib/valine/Valine.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/algoliasearch/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{"valine":{"appId":"rTeTnudkYwu3cz5ejsdiKdFm-gzGzoHsz","appKey":"SfE7A8tmPKu2F6Pf5LMUewa4","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@15.1.2/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"zh-CN","meta":["nick","mail"],"pageSize":10,"placeholder":"在这里留下足迹吧!","recordIP":true,"visitor":true}},"search":{"algoliaAppID":"CT9HNMDY0J","algoliaIndex":"hugo","algoliaSearchKey":"e48b980a6aaab08129f8a8d9a425c47b","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
